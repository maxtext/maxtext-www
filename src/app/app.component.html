<!-- Main Toolbar -->
<mat-toolbar class="main-toolbar mat-elevation-z4">
  <!-- Logo, Brand, and Project Name Container -->
  <a href="#" class="brand-container">
    <mat-icon svgIcon="logo" class="brand-logo"></mat-icon>
    <span class="brand-name">MaxText</span>
    <span class="divider">|</span>
    <span class="project-name">High-Performance LLM</span>
  </a>

  <span class="toolbar-spacer"></span>

  <!-- Navigation Buttons (for larger screens) -->
  <div class="nav-buttons">
    <a mat-button href="/maxtext">API docs</a>
  </div>

  <!-- GitHub Icon Button -->
  <a mat-icon-button href="https://github.com/AI-Hypercomputer/maxtext" target="_blank" aria-label="GitHub Repository">
    <mat-icon svgIcon="github"></mat-icon>
  </a>
</mat-toolbar>

<div class="page-container">
  <!-- Main Content Area with Tabs -->
  <mat-tab-group animationDuration="0ms" mat-stretch-tabs="false" mat-align-tabs="start">

    <!-- Tab 1: Overview -->
    <mat-tab label="Overview">
      <div class="tab-content">
        <mat-card class="content-card">
          <mat-card-header>
            <mat-card-title><h1>MaxText LLM</h1></mat-card-title>
            <mat-card-subtitle>
              High performance, highly scalable, open-source LLM in pure Python/Jax.
              <a href="https://github.com/AI-Hypercomputer/maxtext/actions/workflows/RunTests.yml" target="_blank">
                <img class="build-badge"
                     src="https://github.com/AI-Hypercomputer/maxtext/actions/workflows/RunTests.yml/badge.svg"
                     alt="Unit Tests Status">
              </a>
            </mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <p>
              MaxText is a <strong>high performance</strong>, <strong>highly scalable</strong>,
              <strong>open-source</strong> LLM written in pure Python/Jax and targeting Google Cloud TPUs and GPUs for
              <strong>training</strong> and <strong>inference</strong>. MaxText achieves high MFUs and scales from
              single host to very large clusters&mdash;50k+ TPUs&mdash;while staying simple and "optimization-free" thanks to the power of Jax
              and the XLA compiler.
            </p>
            <h3>Key Supported Features:</h3>
            <mat-chip-listbox>
              <mat-chip-option selected>TPUs and GPUs</mat-chip-option>
              <mat-chip-option selected>Training and Inference</mat-chip-option>
              <mat-chip-option selected>Models: Llama, Mistral, Gemma, DeepSeek</mat-chip-option>
            </mat-chip-listbox>
          </mat-card-content>
        </mat-card>
        <mat-card class="content-card">
          <mat-card-title><h2>Announcements</h2></mat-card-title>
          <mat-card-content>
            <mat-list role="list">
              <mat-list-item role="listitem">
                <mat-icon matListItemIcon>campaign</mat-icon>
                <div matListItemTitle>[July 16, 2025] Repository restructuring planned.</div>
              </mat-list-item>
              <mat-divider></mat-divider>
              <mat-list-item role="listitem" class="highlight-announcement">
                <mat-icon matListItemIcon>priority_high</mat-icon>
                <div matListItemTitle>[April 7, 2025] ðŸš¨ API CHANGE: Modular Imports</div>
                <div matListItemLine>Invoke `train.py` via `python3 -m MaxText.train ...`. Checkout `pre-module-v0.1.0`
                  for old behavior.
                </div>
              </mat-list-item>
              <mat-divider></mat-divider>
              <mat-list-item role="listitem">
                <mat-icon matListItemIcon>developer_mode</mat-icon>
                <div matListItemTitle>[February, 2025] (Preview) Build MaxText Docker images.</div>
              </mat-list-item>
            </mat-list>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>

    <!-- Tab 2: Getting Started -->
    <mat-tab label="Getting Started">
      <div class="tab-content">
        <div class="card-grid">
          <mat-card class="content-card">
            <mat-card-header>
              <mat-icon mat-card-avatar>hub</mat-icon>
              <mat-card-title>Gemma (1-3)</mat-card-title>
            </mat-card-header>
            <mat-card-actions align="end"><a mat-stroked-button href="#">Run Gemma</a></mat-card-actions>
          </mat-card>
          <mat-card class="content-card">
            <mat-card-header>
              <mat-icon mat-card-avatar>hub</mat-icon>
              <mat-card-title>Llama 2</mat-card-title>
            </mat-card-header>
            <mat-card-actions align="end"><a mat-stroked-button href="#">Run Llama2</a></mat-card-actions>
          </mat-card>
          <mat-card class="content-card">
            <mat-card-header>
              <mat-icon mat-card-avatar>hub</mat-icon>
              <mat-card-title>Mixtral</mat-card-title>
            </mat-card-header>
            <mat-card-actions align="end"><a mat-stroked-button href="#">Run Mixtral</a></mat-card-actions>
          </mat-card>
          <mat-card class="content-card">
            <mat-card-header>
              <mat-icon mat-card-avatar>hub</mat-icon>
              <mat-card-title>DeepSeek</mat-card-title>
            </mat-card-header>
            <mat-card-actions align="end"><a mat-stroked-button href="#">Run DeepSeek</a></mat-card-actions>
          </mat-card>
        </div>
      </div>
    </mat-tab>

    <!-- Tab 3: Performance -->
    <mat-tab label="Performance">
      <div class="tab-content">
        <!-- TPU v5p Section -->
        <mat-card class="content-card">
          <mat-card-title>TPU v5p Runtime Performance</mat-card-title>
          <div class="table-container">
            <table mat-table [dataSource]="tpuV5pDataSource" class="mat-elevation-z2">
              <ng-container matColumnDef="params">
                <th mat-header-cell *matHeaderCellDef># Params</th>
                <td mat-cell *matCellDef="let e">{{ e.params }}</td>
              </ng-container>
              <ng-container matColumnDef="accelerator">
                <th mat-header-cell *matHeaderCellDef>Accelerator</th>
                <td mat-cell *matCellDef="let e">{{ e.accelerator }}</td>
              </ng-container>
              <ng-container matColumnDef="tflops">
                <th mat-header-cell *matHeaderCellDef>TFLOP/chip/s</th>
                <td mat-cell *matCellDef="let e">{{ e.tflops | number:'1.2-2' }}</td>
              </ng-container>
              <ng-container matColumnDef="mfu">
                <th mat-header-cell *matHeaderCellDef>MFU</th>
                <td mat-cell *matCellDef="let e"><span>{{ e.mfu }}%</span>
                  <mat-progress-bar mode="determinate" [value]="e.mfu"></mat-progress-bar>
                </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="tpuV5pDisplayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: tpuV5pDisplayedColumns;"></tr>
            </table>
          </div>
        </mat-card>

        <!-- TPU v5e Section -->
        <mat-card class="content-card">
          <mat-card-title>TPU v5e Runtime Performance</mat-card-title>
          <div class="table-container">
            <table mat-table [dataSource]="tpuV5eDataSource" class="mat-elevation-z2">
              <ng-container matColumnDef="hardware">
                <th mat-header-cell *matHeaderCellDef>Hardware</th>
                <td mat-cell *matCellDef="let e">{{ e.hardware }}</td>
              </ng-container>
              <ng-container matColumnDef="mfu_16b">
                <th mat-header-cell *matHeaderCellDef>16B MFU</th>
                <td mat-cell *matCellDef="let e"><span>{{ e.mfu_16b }}%</span>
                  <mat-progress-bar mode="determinate" [value]="e.mfu_16b"></mat-progress-bar>
                </td>
              </ng-container>
              <ng-container matColumnDef="mfu_32b">
                <th mat-header-cell *matHeaderCellDef>32B MFU</th>
                <td mat-cell *matCellDef="let e"><span>{{ e.mfu_32b }}%</span>
                  <mat-progress-bar mode="determinate" [value]="e.mfu_32b"></mat-progress-bar>
                </td>
              </ng-container>
              <ng-container matColumnDef="mfu_64b">
                <th mat-header-cell *matHeaderCellDef>64B MFU</th>
                <td mat-cell *matCellDef="let e"><span>{{ e.mfu_64b }}%</span>
                  <mat-progress-bar mode="determinate" [value]="e.mfu_64b"></mat-progress-bar>
                </td>
              </ng-container>
              <ng-container matColumnDef="mfu_128b">
                <th mat-header-cell *matHeaderCellDef>128B MFU</th>
                <td mat-cell *matCellDef="let e"><span>{{ e.mfu_128b }}%</span>
                  <mat-progress-bar mode="determinate" [value]="e.mfu_128b"></mat-progress-bar>
                </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="tpuV5eDisplayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: tpuV5eDisplayedColumns;"></tr>
            </table>
          </div>
        </mat-card>

        <mat-divider class="section-divider"></mat-divider>

        <!-- Chart Section with Deferrable Views -->
        @defer (on viewport; prefetch on idle) {
          <!-- This component emits the (loaded) event when it is rendered -->
          <app-defer-trigger (loaded)="onChartsLoaded()"></app-defer-trigger>

          <div class="charts-grid">
            <mat-card class="content-card">
              <mat-card-title>TPU v5p MFU Visualization</mat-card-title>
              <mat-card-content class="chart-container">
                <div #v5pChartContainer></div>
              </mat-card-content>
            </mat-card>
            <mat-card class="content-card">
              <mat-card-title>TPU v5e MFU Visualization by Model Size</mat-card-title>
              <mat-card-content class="chart-container">
                <div #v5eChartContainer></div>
              </mat-card-content>
            </mat-card>
          </div>
        } @placeholder {
          <div class="chart-placeholder"></div>
        } @loading {
          <div class="chart-loader">
            <mat-spinner [diameter]="50"></mat-spinner>
            <span>Loading Charts...</span>
          </div>
        }
      </div>
    </mat-tab>

    <!-- Tab 4: Features & Diagnostics -->
    <mat-tab label="Features & Diagnostics">
      <div class="tab-content">
        <mat-accordion multi>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>Comparison to Alternatives</mat-panel-title>
            </mat-expansion-panel-header>
            <p>MaxText is heavily inspired by <strong>MinGPT/NanoGPT</strong>, but is more complex, supporting more
              models and scaling to tens of thousands of chips with >3x the MFU.</p>
            <p>MaxText is similar to <strong>Nvidia/Megatron-LM</strong>, achieving comparable MFUs. MaxText is pure
              Python/XLA, while Megatron-LM is a mix of Python and optimized CUDA kernels.</p>
            <p>MaxText is also comparable to <strong>Pax</strong>. Pax focuses on powerful configuration-driven
              development, whereas MaxText is a simple, concrete implementation that encourages forking and direct
              source code editing.</p></mat-expansion-panel>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>Collect Stack Traces</mat-panel-title>
            </mat-expansion-panel-header>
            <p>You can enable stack trace collection in `MaxText/configs/base.yml`. View traces in Cloud Logging with
              the query:</p>
            <pre><code>logName="projects/&lt;project_name&gt;/logs/tpu.googleapis.com%2Fruntime_monitor"
jsonPayload.verb="stacktraceanalyzer"</code></pre>
          </mat-expansion-panel>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>Ahead of Time Compilation (AOT)</mat-panel-title>
            </mat-expansion-panel-header>
            <p>Use `train_compile.py` on a single CPU or different TPU to pre-compile for a large TPU cluster. This
              flags OOM errors early and allows for fast startup.</p></mat-expansion-panel>
        </mat-accordion>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>

<footer>
  Super-powered by Google &copy;2025. Code licensed under Apache-2.0 License. Documentation licensed under CC BY 4.0.
</footer>
